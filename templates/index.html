<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Citizen Safety Reporting Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- Language Selector - FIXED -->
    <div class="language-selector">
        <div class="dropdown">
            <button class="btn dropdown-toggle" type="button" id="langDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                üåê <span id="currentLangText">{{ lang }}</span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="langDropdown">
                <li><a class="dropdown-item {% if lang == 'English' %}active{% endif %}" href="/set_language/English">üá¨üáß English</a></li>
                <li><a class="dropdown-item {% if lang == 'Kiswahili' %}active{% endif %}" href="/set_language/Kiswahili">üá∞üá™ Kiswahili</a></li>
            </ul>
        </div>
    </div>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="badge-emblem">‚òÖ</div>
            <h1>{{ t.platform_title }}</h1>
            <p class="lead">{{ t.platform_subtitle }}</p>
        </div>
    </div>

    <div class="container py-5">
        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs justify-content-center" role="tablist">
            <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#report-panel">
                    üö® {{ t.report_incident }}
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#track-panel">
                    üîç Track Report
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#help-panel">
                    ‚ùì Help
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content mt-4">
            <!-- Report Incident Panel -->
            <div class="tab-pane fade show active" id="report-panel">
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="feature-card">
                            <img src="/static/images/anonymous.jpg" alt="Anonymous Reporting" class="feature-image" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22200%22%3E%3Crect fill=%22%23667eea%22 width=%22400%22 height=%22200%22/%3E%3Ctext fill=%22white%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2224%22%3EAnonymous%3C/text%3E%3C/svg%3E'">
                            <div class="p-4 text-center">
                                <h5>{{ t.anonymous_reporting }}</h5>
                                <p class="text-muted">{{ t.anonymous_reporting_desc }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="feature-card">
                            <img src="/static/images/local.jpg" alt="Local Response" class="feature-image" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22200%22%3E%3Crect fill=%22%232d5016%22 width=%22400%22 height=%22200%22/%3E%3Ctext fill=%22white%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2224%22%3ELocal Response%3C/text%3E%3C/svg%3E'">
                            <div class="p-4 text-center">
                                <h5>{{ t.local_response }}</h5>
                                <p class="text-muted">{{ t.local_response_desc }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="feature-card">
                            <img src="/static/images/easy.jpg" alt="Easy to Use" class="feature-image" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22200%22%3E%3Crect fill=%22%230074D9%22 width=%22400%22 height=%22200%22/%3E%3Ctext fill=%22white%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2224%22%3EEasy to Use%3C/text%3E%3C/svg%3E'">
                            <div class="p-4 text-center">
                                <h5>{{ t.easy_to_use }}</h5>
                                <p class="text-muted">{{ t.easy_to_use_desc }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-4">
                    <a href="/report" class="btn btn-military btn-lg">
                        üö® {{ t.report_incident }}
                    </a>
                </div>
            </div>

            <!-- Track Report Panel -->
            <div class="tab-pane fade" id="track-panel">
                <div class="track-section">
                    <h2 class="mb-4 text-center" style="color: var(--police-navy); font-weight: 700;">Track Your Report</h2>
                    <p class="text-muted mb-4 text-center">Enter your report reference number to check its status</p>

                    <div class="search-box mb-3">
                        <input type="text" id="reportId" class="form-control" placeholder="Enter your report reference number">
                        <button class="search-btn" onclick="trackReport()">üîç</button>
                    </div>

                    <div id="reportResult" class="report-result">
                        <h4 class="mb-3" style="color: var(--police-navy);">Report Details</h4>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <strong>Report ID:</strong><br>
                                <span id="resultId" style="font-family: 'Courier New', monospace; color: var(--police-blue); font-weight: bold;"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <strong>Status:</strong><br>
                                <span id="resultStatus"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <strong>Category:</strong><br>
                                <span id="resultCategory"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <strong>Submitted:</strong><br>
                                <span id="resultDate"></span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <strong>Location:</strong><br>
                            <span id="resultLocation"></span>
                        </div>
                        <div id="responseSection" style="display: none;" class="mt-4 pt-4 border-top">
                            <h5 class="mb-3" style="color: var(--military-green);">Police Response</h5>
                            <div class="mb-2"><strong>Officer:</strong> <span id="resultOfficer"></span></div>
                            <div class="mb-2"><strong>Action Taken:</strong><br><span id="resultAction"></span></div>
                            <div class="mb-2"><strong>Notes:</strong><br><span id="resultNotes"></span></div>
                        </div>
                    </div>

                    <div id="notFoundMessage" class="alert alert-warning mt-3" style="display: none;">
                        <strong>Report not found.</strong> Please check your reference number and try again.
                    </div>
                </div>
            </div>

            <!-- Help Panel -->
            <div class="tab-pane fade" id="help-panel">
                <div class="track-section">
                    <h2 class="mb-4 text-center" style="color: var(--police-navy); font-weight: 700;">Help & Information</h2>

                    <div class="mb-4 p-4" style="background: linear-gradient(135deg, var(--alert-red) 0%, #c82333 100%); border-radius: 15px; color: white;">
                        <h5 style="color: white;">{{ t.emergency_call }}</h5>
                        <p class="lead mb-0"><strong>üìû 0725646760</strong></p>
                        <small>For immediate emergencies, please call this number directly.</small>
                    </div>

                    <hr>

                    <div class="mb-4">
                        <h5 style="color: var(--police-navy);">How to Report an Incident</h5>
                        <ol class="text-muted">
                            <li>Click on "Report Incident" tab</li>
                            <li>Fill in the incident details (category, description, location)</li>
                            <li>Optionally attach photos or videos</li>
                            <li>Submit your report</li>
                            <li>Save your Report ID to track status</li>
                        </ol>
                    </div>

                    <hr>

                    <div class="mb-4">
                        <h5 style="color: var(--police-navy);">Tracking Your Report</h5>
                        <p class="text-muted">After submitting a report, you'll receive a unique Report ID. Use this ID in the "Track Report" tab to check the status of your report.</p>
                    </div>

                    <hr>

                    <div class="mb-4">
                        <h5 style="color: var(--police-navy);">Staff Access</h5>
                        <div class="d-flex gap-2">
                            <a href="/police/login" class="btn btn-police">üëÆ {{ t.police_login }}</a>
                            <a href="/admin/login" class="btn btn-military">üõ°Ô∏è {{ t.admin_login }}</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center">
        <div class="container">
            <p class="mb-1" style="font-weight: 700; text-transform: uppercase; letter-spacing: 2px;">
                {{ t.copyright }} ¬© 2025
            </p>
            <p class="mb-0" style="color: var(--police-gold);">
                {{ t.emergency_call }}: <strong>0725646760</strong>
            </p>
            <small style="opacity: 0.8;">Serving Nakuru with Honor and Integrity</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/index.js"></script>

    <!-- Language Selector Script -->
    <script>
        // Update current language text display
        document.addEventListener('DOMContentLoaded', function() {
            const currentLang = '{{ lang }}';
            const langText = document.getElementById('currentLangText');
            if (langText) {
                langText.textContent = currentLang;
            }

            // Add active class to current language
            document.querySelectorAll('.dropdown-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // Show loading state
                    const btn = document.getElementById('langDropdown');
                    btn.innerHTML = 'üåê <span class="spinner-border spinner-border-sm"></span> Loading...';
                });
            });
        });
    </script>
</body>
</html>